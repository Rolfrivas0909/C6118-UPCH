---
title: "Análisis de las condiciones del océano frente a Perú durante el año 1991"
author: "Rolf Rivas"
output:
  html_document
---
## Introducción
La temperatura y salinidad son las variables más usadas en oceanografía, ya que definen masas de agua y su densidad. Anomalias en la temperatura y salinidad tienen efecto en las comunidades biológicas como el fitoplancton. Durante los años 1991-1992 se registro un Niño, el cual fue considerado como moderado (SENAMHI 2014; Tahakashi, 2016). El objetivo de este trabajo es analizar la temperatura, salinidad y fitoplancton del océano frente a Perú para el año **1991**.

## Materiales y métodos
### Materiales  
* Para realizar los análisis se usó los datos de temperatura superficial del mar(SST), salinidad (SSS) y fitoplancton (phy) de la liberia netCDF (**Network Common Data Form**). Además se usó el paquete estadístico R y los paquetes de R: markdown, kali, ncdf4 y fields.
 

### Métodos  
* Se realizaron comparaciones entre los promedios totales de las variables y las anomalias.  

     + Las anomalias se definieron como: Anomalias=Promedio(todos los años)-Promedio(año 1991)

## Resultados y discusión

```{r}
library(ncdf4)
library(fields)
library(kali)
```

###**Promedio de temperatura para todos los años**
```{r}
nc_sst=nc_open("datos/sst.nc4")
sst = ncvar_get(nc_sst, "to")
tiempo= ncvar_get(nc_sst, "time")
sst_promedio=apply(sst, MARGIN=3,FUN=mean, na.rm=TRUE)
plot(tiempo, sst_promedio,type="l", col="blue",las=1, xlab="tiempo",ylab="temperatura promedio")
abline(v=c(385,396+(9-1)/12),lty=2,col="red")
```


###**Análisis de la temperatura superficial del mar, salinidad y fitoplancton durante el año 1991.**

```{r}
nc_sst=nc_open("datos/sst.nc4")
nc_sss=nc_open("datos/sss.nc4")
nc_lphy=nc_open("datos/lphy.nc4")
nc_sphy=nc_open("datos/sphy.nc4")
sst = ncvar_get(nc_sst, "to")
sss = ncvar_get(nc_sss, "so")
lphy = ncvar_get(nc_lphy, "intpp")
sphy = ncvar_get(nc_sphy, "intpp")
par(mfrow=c(2,2))
tiempo= ncvar_get(nc_sst, "time")
#Grafico promedio de SST
tiempo=c(385:396)
promsst=apply(sst[,,385:396], MARGIN=3,FUN=mean, na.rm=TRUE)
promsss=apply(sss[,,385:396], MARGIN=3,FUN=mean, na.rm=TRUE)
promlphy=apply(lphy[,,385:396], MARGIN=3,FUN=mean, na.rm=TRUE)
promsphy=apply(sphy[,,385:396], MARGIN=3,FUN=mean, na.rm=TRUE)
plot(tiempo,promsst,type="l", col="blue",las=1, xlab="tiempo",ylab="temperatura promedio")
plot(tiempo,promsss,type="l", col="red",las=1, xlab="tiempo",ylab="salinidad promedio")
plot(tiempo,promlphy,type="l", col="orange",las=1, xlab="tiempo",ylab="Fitoplancton grande")
plot(tiempo,promsphy,type="l", col="orange",las=1, xlab="tiempo",ylab="Fitoplancton pequeño")
```


###**Temperatura promedio y anomalia para año 1991**
```{r}
#variable sst
nc_sst=nc_open("datos/sst.nc4")
sst = ncvar_get(nc_sst, "to")
lat = ncvar_get(nc_sst, "latitude")
lon = ncvar_get(nc_sst, "longitude") - 360
tiempo= ncvar_get(nc_sst, "time")
par(mfrow=c(1,2))
#Grafico promedio de SST
sst_promedio=apply(sst[,,1:552], MARGIN = c(1,2), FUN=mean, na.rm = TRUE)
image.map(lon, lat, sst_promedio)
title("PROMEDIO SST° 1959-2005")

#Grafico promedio de año 1991
sst_ano1991=apply(sst[,,384:396], MARGIN = c(1,2), FUN = mean, na.rm = TRUE)
anomalia_sst=sst_promedio-sst_ano1991
image.map(lon, lat, anomalia_sst)
title("Anomalías SST año 1991")
```


###**Salinidad promedio y anomalia para año 1991**
```{r}
##variable sss
nc_sss=nc_open("datos/sss.nc4")
sss=ncvar_get(nc_sss,"so")
lat=ncvar_get(nc_sss,"latitude")
lon=ncvar_get(nc_sss,"longitude") - 360
par(mfrow=c(1,2))
#Grafico promedio de SSS

sss_promedio=apply(sss[,,1:552], MARGIN = c(1,2), FUN=mean, na.rm = TRUE)
image.map(lon, lat, sss_promedio)
title("PROMEDIO SALINIDAD° 1959-2005")

#Grafico promedio de año SSS 1991

sss_ano1991=apply(sss[,,384:396], MARGIN = c(1,2), FUN = mean, na.rm = TRUE)
anomalia_sss=sss_promedio-sss_ano1991
image.map(lon, lat, anomalia_sss)
title("Anomalías salinidad año 1991")
```


###***Fitoplancton promedio y anomalia para año 1991**.

```{r}
nc_lphy=nc_open("datos/lphy.nc4")
nc_sphy=nc_open("datos/sphy.nc4")
lphy= ncvar_get(nc_lphy, "intpp")
sphy= ncvar_get(nc_sphy, "intpp")
lat_sphy = ncvar_get(nc_sphy, "latitude")
lon_sphy= ncvar_get(nc_sphy, "longitude") - 360
lat_lphy = ncvar_get(nc_lphy, "latitude")
lon_lphy= ncvar_get(nc_lphy, "longitude") - 360
par(mfrow=c(2,2))

#Grafico promedio total de phyto grande y pequeño

sphy_promedio=apply(sphy[,,1:552],MARGIN = c(1,2), FUN=mean, na.rm = TRUE)
image.map(lon_sphy, lat_sphy, sphy_promedio)
title("Densidad fitoplancton pequeño 1959-2005")
lphy_promedio=apply(lphy[,,1:552],MARGIN = c(1,2), FUN=mean, na.rm = TRUE)
image.map(lon_sphy, lat_sphy, sphy_promedio)
title("Densidad fitoplancton grande 1959-2005")

#Grafico promedio de año 1991 phyto grande y pequeño
sphy_ano1991=apply(sphy[,,384:396],MARGIN = c(1,2), FUN=mean, na.rm = TRUE)
image.map(lon_sphy, lat_sphy, sphy_ano1991)
title("Densidad fitoplancton pequeño año 1991")

lphy_ano1991=apply(lphy[,,384:396],MARGIN = c(1,2), FUN=mean, na.rm = TRUE)
image.map(lon_lphy, lat_lphy, lphy_ano1991)
title("Densidad fitoplancton grande año 1991")
```

## Conclusiones
Durante el año 1991 hubo anomalia positiva de la temperatura superficial del mar y una anomalia negativa de la salinidad del mar en Perú.

## Referencias

-(SENAMHI. 2014. El fenomeno El Niño en el Perú.)[http://www.minam.gob.pe/wp-content/uploads/2014/07/Dossier-El-Niño-Final_web.pdf]

-(Takahashi, K. & Dewitte, B. 2016.Clim Dyn 46: 1627.)[https://link.springer.com/article/10.1007/s00382-015-2665-3]

